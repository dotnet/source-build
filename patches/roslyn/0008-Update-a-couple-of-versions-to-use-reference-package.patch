From f481c191dc60b4112dc2def485982139e7c7d839 Mon Sep 17 00:00:00 2001
From: dseefeld <dseefeld@microsoft.com>
Date: Thu, 24 Sep 2020 15:19:14 +0000
Subject: [PATCH] Update a couple of versions to use reference packages

---
 src/Compilers/Directory.Build.props                   | 9 +++++++++
 src/Compilers/Server/VBCSCompiler/VBCSCompiler.csproj |  1 +
 2 files changed, 10 insertions(+)
 create mode 100644 src/Compilers/Directory.Build.props

diff --git a/src/Compilers/Directory.Build.props b/src/Compilers/Directory.Build.props
new file mode 100644
index 0000000..b543826
--- /dev/null
+++ b/src/Compilers/Directory.Build.props
@@ -0,0 +1,9 @@
+<Project>
+  <Import Project="$([MSBuild]::GetPathOfFileAbove('Directory.Build.props', '$(MSBuildThisFileDirectory)../'))" />
+  <PropertyGroup>
+    <!-- When building from source, lock these versions to reference package versions
+         rather than getting the versions from package flow.  Source-built versions of
+         these packages only support building net5.0 -->
+    <SystemIOPipesAccessControlVersion>4.5.1</SystemIOPipesAccessControlVersion>
+  </PropertyGroup>
+</Project>
diff --git a/src/Compilers/Server/VBCSCompiler/VBCSCompiler.csproj b/src/Compilers/Server/VBCSCompiler/VBCSCompiler.csproj
index 3fde7d7..7eb6dad 100644
--- a/src/Compilers/Server/VBCSCompiler/VBCSCompiler.csproj
+++ b/src/Compilers/Server/VBCSCompiler/VBCSCompiler.csproj
@@ -19,6 +19,7 @@
   <ItemGroup>
     <Reference Include="System.Configuration" Condition="'$(TargetFramework)' != 'netcoreapp3.1'" />
     <PackageReference Include="System.IO.Pipes.AccessControl" Version="$(SystemIOPipesAccessControlVersion)" Condition="'$(TargetFramework)' == 'netcoreapp3.1'" />
+    <PackageReference Include="System.Collections.Immutable" Version="$(SystemCollectionsImmutableVersion)" />
   </ItemGroup>
   <ItemGroup>
     <Compile Include="..\..\Shared\RuntimeHostInfo.cs" />
--
1.8.3.1

