From 411d242b0d3e92e435b115c77b31f641666ad55b Mon Sep 17 00:00:00 2001
From: dseefeld <dseefeld@microsoft.com>
Date: Thu, 31 Oct 2019 16:00:53 +0000
Subject: [PATCH] Conditionally set PackAsTool

---
 src/Tools/Microsoft.dotnet-openapi/src/Microsoft.dotnet-openapi.csproj | 2 +-
 src/Tools/dotnet-dev-certs/src/dotnet-dev-certs.csproj                 | 2 +-
 src/Tools/dotnet-sql-cache/src/dotnet-sql-cache.csproj                 | 2 +-
 src/Tools/dotnet-user-secrets/src/dotnet-user-secrets.csproj           | 2 +-
 src/Tools/dotnet-watch/src/dotnet-watch.csproj                         | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/src/Tools/Microsoft.dotnet-openapi/src/Microsoft.dotnet-openapi.csproj b/src/Tools/Microsoft.dotnet-openapi/src/Microsoft.dotnet-openapi.csproj
index b425a99..96f31c9 100644
--- a/src/Tools/Microsoft.dotnet-openapi/src/Microsoft.dotnet-openapi.csproj
+++ b/src/Tools/Microsoft.dotnet-openapi/src/Microsoft.dotnet-openapi.csproj
@@ -6,7 +6,7 @@
     <RootNamespace>Microsoft.DotNet.Openapi.Tools</RootNamespace>
     <AssemblyName>dotnet-openapi</AssemblyName>
     <PackageId>Microsoft.dotnet-openapi</PackageId>
-    <PackAsTool>true</PackAsTool>
+    <PackAsTool Condition="'$(DotNetBuildFromSource)' != 'true'">true</PackAsTool>
     <IsShippingPackage>true</IsShippingPackage>
   </PropertyGroup>
 
diff --git a/src/Tools/dotnet-dev-certs/src/dotnet-dev-certs.csproj b/src/Tools/dotnet-dev-certs/src/dotnet-dev-certs.csproj
index 27fea60..15ce670 100644
--- a/src/Tools/dotnet-dev-certs/src/dotnet-dev-certs.csproj
+++ b/src/Tools/dotnet-dev-certs/src/dotnet-dev-certs.csproj
@@ -6,7 +6,7 @@
     <Description>Command line tool to generate certificates used in ASP.NET Core during development.</Description>
     <RootNamespace>Microsoft.AspNetCore.DeveloperCertificates.Tools</RootNamespace>
     <PackageTags>dotnet;developercertificates</PackageTags>
-    <PackAsTool>true</PackAsTool>
+    <PackAsTool Condition="'$(DotNetBuildFromSource)' != 'true'">true</PackAsTool>
     <!-- This package is for internal use only. It contains a CLI which is bundled in the .NET Core SDK. -->
     <IsShippingPackage>false</IsShippingPackage>
     <ExcludeFromSourceBuild>false</ExcludeFromSourceBuild>
diff --git a/src/Tools/dotnet-sql-cache/src/dotnet-sql-cache.csproj b/src/Tools/dotnet-sql-cache/src/dotnet-sql-cache.csproj
index 83199e9..27ba426 100644
--- a/src/Tools/dotnet-sql-cache/src/dotnet-sql-cache.csproj
+++ b/src/Tools/dotnet-sql-cache/src/dotnet-sql-cache.csproj
@@ -5,7 +5,7 @@
     <OutputType>exe</OutputType>
     <Description>Command line tool to create tables and indexes in a Microsoft SQL Server database for distributed caching.</Description>
     <PackageTags>cache;distributedcache;sqlserver</PackageTags>
-    <PackAsTool>true</PackAsTool>
+    <PackAsTool Condition="'$(DotNetBuildFromSource)' != 'true'">true</PackAsTool>
     <IsShippingPackage>true</IsShippingPackage>
   </PropertyGroup>
 
diff --git a/src/Tools/dotnet-user-secrets/src/dotnet-user-secrets.csproj b/src/Tools/dotnet-user-secrets/src/dotnet-user-secrets.csproj
index 5f4ec16..fcf85d6 100644
--- a/src/Tools/dotnet-user-secrets/src/dotnet-user-secrets.csproj
+++ b/src/Tools/dotnet-user-secrets/src/dotnet-user-secrets.csproj
@@ -7,7 +7,7 @@
     <GenerateUserSecretsAttribute>false</GenerateUserSecretsAttribute>
     <RootNamespace>Microsoft.Extensions.SecretManager.Tools</RootNamespace>
     <PackageTags>configuration;secrets;usersecrets</PackageTags>
-    <PackAsTool>true</PackAsTool>
+    <PackAsTool Condition="'$(DotNetBuildFromSource)' != 'true'">true</PackAsTool>
     <!-- This package is for internal use only. It contains a CLI which is bundled in the .NET Core SDK. -->
     <IsShippingPackage>false</IsShippingPackage>
     <ExcludeFromSourceBuild>false</ExcludeFromSourceBuild>
diff --git a/src/Tools/dotnet-watch/src/dotnet-watch.csproj b/src/Tools/dotnet-watch/src/dotnet-watch.csproj
index f77d472..8f85f0b 100644
--- a/src/Tools/dotnet-watch/src/dotnet-watch.csproj
+++ b/src/Tools/dotnet-watch/src/dotnet-watch.csproj
@@ -6,7 +6,7 @@
     <Description>Command line tool to watch for source file changes during development and restart the dotnet command.</Description>
     <RootNamespace>Microsoft.DotNet.Watcher.Tools</RootNamespace>
     <PackageTags>dotnet;watch</PackageTags>
-    <PackAsTool>true</PackAsTool>
+    <PackAsTool Condition="'$(DotNetBuildFromSource)' != 'true'">true</PackAsTool>
     <!-- This package is for internal use only. It contains a CLI which is bundled in the .NET Core SDK. -->
     <IsShippingPackage>false</IsShippingPackage>
     <ExcludeFromSourceBuild>false</ExcludeFromSourceBuild>
-- 
1.8.3.1

