From 87e4ebd85f0660c688163b62f99ef24549e4b77d Mon Sep 17 00:00:00 2001
From: dseefeld <dseefeld@microsoft.com>
Date: Wed, 15 Jan 2020 15:14:54 +0000
Subject: [PATCH] Add source-build specific build script

---
 build-source-build.sh | 64 +++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 64 insertions(+)
 create mode 100755 build-source-build.sh

diff --git a/build-source-build.sh b/build-source-build.sh
new file mode 100755
index 0000000..1607ef2
--- /dev/null
+++ b/build-source-build.sh
@@ -0,0 +1,64 @@
+#!/usr/bin/env bash
+
+source="${BASH_SOURCE[0]}"
+
+# resolve $SOURCE until the file is no longer a symlink
+while [[ -h $source ]]; do
+  scriptroot="$( cd -P "$( dirname "$source" )" && pwd )"
+  source="$(readlink "$source")"
+
+  # if $source was a relative symlink, we need to resolve it relative to the path where the
+  # symlink file was located
+  [[ $source != /* ]] && source="$scriptroot/$source"
+done
+
+scriptroot="$( cd -P "$( dirname "$source" )" && pwd )"
+
+capture="common"
+
+for arg do
+  shift
+  opt="$(echo "$arg" | awk '{print tolower($0)}')"
+  case $opt in
+    (--coreclr-args)
+            capture="coreclr"
+            arg=""
+            ;;
+    (--libraries-args)
+            capture="libraries"
+            arg=""
+            ;;
+    (--installer-args)
+            capture="installer"
+            arg=""
+            ;;
+       (*) ;;
+  esac
+
+  if [ "$arg" != "" ]; then
+      case $capture in
+        (common)
+            commonArgs="$commonArgs $arg"
+            ;;
+        (coreclr)
+            coreclrArgs="$coreclrArgs $arg"
+            ;;
+        (libraries)
+            librariesArgs="$librariesArgs $arg"
+            ;;
+        (installer)
+            installerArgs="$installerArgs $arg"
+            ;;
+        (*) ;;
+      esac
+  fi
+done
+
+echo "commonArgs = [$commonArgs]"
+echo "coreclrArgs = [$coreclrArgs]"
+echo "librariesArgs = [$librariesArgs]"
+echo "installerArgs = [$installerArgs]"
+
+$scriptroot/src/coreclr/build.sh $coreclrArgs
+$scriptroot/libraries.sh $librariesArgs
+$scriptroot/installer.sh $installerArgs
-- 
1.8.3.1

