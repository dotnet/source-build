<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask AssemblyFile="$(TaskDirectory)Microsoft.DotNet.SourceBuild.Tasks/bin/Debug/netstandard1.4/Microsoft.DotNet.SourceBuild.Tasks.dll" TaskName="WriteVersionsFile" />

  <PropertyGroup>
    <StandardDirectory>$(SubmoduleDirectory)standard/</StandardDirectory>
    <StandardPackageOutputDirectory>$(StandardDirectory)bin/packages/$(Configuration)/</StandardPackageOutputDirectory>
  </PropertyGroup>

  <!-- Standard Targets -->
  <Target Name="BuildStandard">
    <Exec Command="$(StandardDirectory)build$(ShellExtension) -$(Configuration)"
          WorkingDirectory="$(StandardDirectory)" />

    <ItemGroup>
      <StandardPackages Include="$(StandardPackageOutputDirectory)*.nupkg" />
    </ItemGroup>

    <Copy SourceFiles="@(StandardPackages)"
          DestinationFolder="$(SourceBuiltPackagesPath)" />

    <WriteVersionsFile NugetPackages="@(StandardPackages)"
                       OutputPath="$(IntermediatePath)StandardVersions.txt" />
  </Target>

  <!-- no-op right now as dotnet/standard doesn't have clean.sh -->
  <Target Name="CleanStandard" />
</Project>
