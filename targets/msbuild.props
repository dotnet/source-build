<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectDirectory Condition="'$(PathToRepo)' != ''">$(PathToRepo)</ProjectDirectory>
    <DotNetTool>$(ToolsDir)/dotnetcli/dotnet</DotNetTool>
    <DotnetToolsetInstallOverride>DOTNET_TOOLSET_DIR=$(PreBuiltPjDotnetCliDir) </DotnetToolsetInstallOverride>
    <OverridesForCommands>$(PackagesOverride) $(DotnetToolsetInstallOverride) $(BuildToolsetInstallOverride) </OverridesForCommands>
    <SyncCommand Condition="'$(TagetOS)' != 'Windows_NT'" >$(OverridesForCommands)  $(ProjectDirectory)/init-tools$(ShellExtension); $(PreBuiltDotnetCliDir)/dotnet $(ProjectDirectory)/Tools/MSBuild.exe /m /t:BulkRestoreNugetPackages /p:ToolPackagesDir=$(PackagesDir); $(OverridesForCommands) $(ProjectDirectory)Tools/dotnetcli/dotnet restore $(ProjectDirectory)src/Framework $(ProjectDirectory)src/Utilities $(ProjectDirectory)src/Build  $(ProjectDirectory)src/MSBuild $(ProjectDirectory)src/Tasks; $(OverridesForCommands) $(DotNetTool) restore $(ProjectDirectory)/build/core-packager/packager.csproj ; $(OverridesForCommands) $(ProjectDirectory)Tools/dotnetcli/dotnet restore $(ProjectDirectory)targets/runtimeDependencies/project.json; $(OverridesForCommands) $(ProjectDirectory)Tools/dotnetcli/dotnet restore $(ProjectDirectory)targets/roslyn/project.json; </SyncCommand>
    <BuildPropertyOverrides>/p:PackagesDir=$(PackagesDir) /p:SkipBulkRestore=false /p:ToolPackagesDir=$(PackagesDir) /p:SkipRestoreBuildToolsPackagesConfig=true /p:SkipTestBuild=true /p:BuildSamples=false /p:NetCoreBuild=true /p:NuGetRuntimeIdentifier=$(TargetRid)</BuildPropertyOverrides>
    <BuildCommand>BUILD_ARGS="$(BuildPropertyOverrides)" $(OverridesForCommands) $(ProjectDirectory)/cibuild$(ShellExtension) --scope Compile --target CoreCLR --host CoreCLR --build-only </BuildCommand>
    <BuildPackagesCommand>$(OverridesForCommands) $(DotNetTool) build /t:PackAll $(ProjectDirectory)/build/core-packager/packager.csproj /p:PackagesDir=$(PackagesDir) /p:ToolPackagesDir=$(PackagesDir)</BuildPackagesCommand>
    <PackagesOutput>$(ProjectDirectory)/build/core-packager/bin/$(Configuration)/</PackagesOutput>
  </PropertyGroup>
</Project>
